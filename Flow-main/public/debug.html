<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Flow Debug</title>
  <style>
    body { font-family: monospace; background: #f8f8f8; color: #222; padding: 2em; }
    pre { background: #fff; border: 1px solid #ccc; padding: 1em; }
  </style>
</head>
<body>
  <h1>Flow Runtime Debug</h1>
  <pre id="info">Loading...</pre>
  <script>
    async function getSW() {
      if (!('serviceWorker' in navigator)) return [];
      if (!navigator.serviceWorker.getRegistrations) return [];
      const regs = await navigator.serviceWorker.getRegistrations();
      return regs.map(r => ({scope: r.scope, active: !!r.active, scriptURL: r.active?.scriptURL || null}));
    }
    (async () => {
      const info = {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        language: navigator.language,
        colorScheme: window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light',
        serviceWorkers: await getSW(),
        url: location.href,
        time: new Date().toISOString(),
        localStorage: {
          theme: localStorage.getItem('theme'),
          keys: Object.keys(localStorage)
        }
      };
      document.getElementById('info').textContent = JSON.stringify(info, null, 2);
    })();
  </script>
</body>
</html>
