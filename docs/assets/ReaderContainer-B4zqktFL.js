import{r as o,j as e,R as U}from"./animations-D9Wo9mUM.js";import{u as q,T as X}from"./index-BBExEBB4.js";import{u as V,R as C}from"./rsvp-eqVIbU96.js";import{T as B}from"./cloud-Be3Yh6fZ.js";import{M as J,l as K,m as Q,n as Z,o as ee,P as te,p as se,q as ne,E as ie,r as ae,s as oe,t as re}from"./icons-DhCoUMbR.js";import"./vendor-react-uIRdnfX0.js";class E{constructor(){this.words=[],this.sourceText="",this.totalWords=0,this._position=0,this._isPlaying=!1,this._wpm=300,this.playbackTimer=null,this.positionListeners=new Set,this.playStateListeners=new Set}static getInstance(){return E.instance||(E.instance=new E),E.instance}load(i){if(this.stop(),this.sourceText=i,this.words=[],!i||i.length===0){this.totalWords=0;return}const a=Math.ceil(i.length/5);this.words=new Array(a);let t=0,n=-1,r=!0,l=!1;for(let g=0;g<=i.length;g++){const p=g<i.length?i[g]:" ",m=p===" "||p==="	"||p===`
`||p==="\r";if(p===`
`&&(l=!0),m&&!r&&n>=0){const v=i.slice(n,g);let x=0;const y=v[v.length-1];y==="."||y==="!"||y==="?"?x=2:(y===","||y===";"||y===":"||y==="â€”"||y==="â€“")&&(x=1),this.words[t]={text:v,start:n,end:g,index:t,trailingPause:x},t++,n=-1}else!m&&r&&(n=g,l&&t>0&&(this.words[t-1].trailingPause=3),l=!1);r=m}this.words.length=t,this.totalWords=t}get position(){return this._position}set position(i){const a=Math.max(0,Math.min(this.totalWords-1,i));a!==this._position&&(this._position=a,this.notifyPosition())}get progress(){return this.totalWords>0?this._position/this.totalWords:0}set progress(i){this.position=Math.floor(i*this.totalWords)}get total(){return this.totalWords}getWord(i){return this.words[i]||null}getCurrentWord(){return this.words[this._position]||null}getWindow(i,a){const t=Math.max(0,this._position-i),n=Math.min(this.totalWords,this._position+a);return this.words.slice(t,n)}getRange(i,a){const t=Math.max(0,i),n=Math.min(this.totalWords,t+a);return this.words.slice(t,n)}getParagraphs(i,a){const t=[];let n=[],r=i;for(let l=i;l<this.totalWords&&t.length<a;l++){const g=this.words[l];n.length===0&&(r=l),n.push(g),g.trailingPause===3&&(t.push({words:n,startIndex:r}),n=[])}return n.length>0&&t.length<a&&t.push({words:n,startIndex:r}),t}wordIndexFromProgress(i){return Math.floor(i*this.totalWords)}get isPlaying(){return this._isPlaying}get wpm(){return this._wpm}set wpm(i){this._wpm=Math.max(50,Math.min(1500,i)),this._isPlaying&&(this.stop(),this.play())}play(){this._isPlaying||this.totalWords===0||(this._isPlaying=!0,this.notifyPlayState(),this.scheduleNext())}stop(){this.playbackTimer!==null&&(clearTimeout(this.playbackTimer),this.playbackTimer=null),this._isPlaying&&(this._isPlaying=!1,this.notifyPlayState())}toggle(){this._isPlaying?this.stop():this.play()}scheduleNext(){if(!this._isPlaying)return;const i=this.getCurrentWord();if(!i){this.stop();return}let a=6e4/this._wpm;const t=i.trailingPause;t===1?a*=1.3:t===2?a*=1.8:t===3&&(a*=2.2);const n=i.text.length;n>10?a*=1.2:n>7?a*=1.1:n<=2&&(a*=.85),this.playbackTimer=window.setTimeout(()=>{this._position<this.totalWords-1?(this.position=this._position+1,this.scheduleNext()):this.stop()},a)}skipForward(i=10){this.position=this._position+i}skipBack(i=10){this.position=this._position-i}jumpToStart(){this.position=0}jumpToEnd(){this.position=this.totalWords-1}onPosition(i){return this.positionListeners.add(i),()=>this.positionListeners.delete(i)}onPlayState(i){return this.playStateListeners.add(i),()=>this.playStateListeners.delete(i)}notifyPosition(){const i=this._position;this.positionListeners.forEach(a=>a(i))}notifyPlayState(){const i=this._isPlaying;this.playStateListeners.forEach(a=>a(i))}getStats(){return{totalWords:this.totalWords,position:this._position,progress:this.progress,isPlaying:this._isPlaying,wpm:this._wpm}}}const le=o.memo(({words:d,startIndex:i,activeIndex:a,isNearActive:t,fontSize:n,lineHeight:r,paragraphSpacing:l,fontFamily:g,textColor:p,accentColor:m,onWordTap:u})=>{const v=g==="New York"?'"New York", "Iowan Old Style", Georgia, serif':g==="OpenDyslexic"?'"OpenDyslexic", sans-serif':g==="Atkinson Hyperlegible"?'"Atkinson Hyperlegible", sans-serif':"system-ui, -apple-system, sans-serif";if(!t){const x=d.map(y=>y.text).join(" ");return e.jsx("p",{"data-start":i,style:{fontSize:`${n}px`,lineHeight:r,marginBottom:`${l}px`,fontFamily:v,color:p,textAlign:"justify",hyphens:"auto",WebkitHyphens:"auto",textRendering:"optimizeLegibility",WebkitFontSmoothing:"antialiased"},children:x})}return e.jsx("p",{"data-start":i,style:{fontSize:`${n}px`,lineHeight:r,marginBottom:`${l}px`,fontFamily:v,color:p,textAlign:"justify",hyphens:"auto",WebkitHyphens:"auto",textRendering:"optimizeLegibility",WebkitFontSmoothing:"antialiased"},children:d.map((x,y)=>{const b=x.index===a;return e.jsxs(U.Fragment,{children:[e.jsx("span",{"data-idx":x.index,style:{backgroundColor:b?m:"transparent",color:b?"#FFFFFF":"inherit",padding:b?"3px 6px":"0",margin:b?"-3px -6px":"0",borderRadius:b?"6px":"0",transition:"all 0.15s ease-out",boxShadow:b?`0 2px 8px ${m}40`:"none"},children:x.text}),y<d.length-1?" ":""]},x.index)})})}),ce=o.memo(({word:d,nextWords:i,prevWords:a,fontSize:t,fontFamily:n,textColor:r,accentColor:l,showGhost:g})=>{if(!d)return null;const p=n==="New York"?'"New York", "Iowan Old Style", Georgia, serif':n==="OpenDyslexic"?'"OpenDyslexic", sans-serif':n==="Atkinson Hyperlegible"?'"Atkinson Hyperlegible", sans-serif':"system-ui, -apple-system, sans-serif",m=Math.min(t*2.2,56),u=d.text,v=u.length<=1?0:u.length<=5?1:u.length<=9?2:u.length<=13?3:4,x=u.slice(0,v),y=u[v]||"",b=u.slice(v+1);if(g){const W=m*.5,j=m*.9;return e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center select-none overflow-hidden",children:[a.length>0&&e.jsx("div",{className:"absolute text-right px-6",style:{bottom:`calc(50% + ${j}px)`,right:"50%",marginRight:`${m*.15}px`,fontFamily:p,fontSize:`${W}px`,color:r,opacity:.3,maxWidth:"45vw",lineHeight:1.5,textAlign:"justify"},children:a.map(M=>M.text).join(" ")}),e.jsx("div",{className:"relative flex items-center justify-center w-full",children:e.jsxs("div",{className:"flex items-baseline relative animate-word-in",style:{fontFamily:p,fontSize:`${m}px`,fontWeight:500,letterSpacing:"0.01em"},children:[e.jsx("span",{className:"text-right",style:{color:r,minWidth:"42vw",paddingRight:"3px"},children:x}),e.jsxs("span",{className:"relative",style:{color:l,fontWeight:700},children:[y,e.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 rounded-full animate-breathe",style:{bottom:`-${m*.25}px`,width:`${Math.max(4,m*.12)}px`,height:`${Math.max(4,m*.12)}px`,backgroundColor:l,boxShadow:`0 0 8px ${l}60, 0 0 16px ${l}30`}})]}),e.jsx("span",{className:"text-left",style:{color:r,minWidth:"42vw",paddingLeft:"3px"},children:b})]},d.index)}),i.length>0&&e.jsx("div",{className:"absolute text-left px-6",style:{top:`calc(50% + ${j}px)`,left:"50%",marginLeft:`${m*.15}px`,fontFamily:p,fontSize:`${W}px`,color:r,opacity:.25,maxWidth:"45vw",lineHeight:1.5,textAlign:"justify"},children:i.map(M=>M.text).join(" ")})]})}return e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center select-none overflow-hidden",children:e.jsx("div",{className:"relative flex items-center justify-center w-full",children:e.jsxs("div",{className:"flex items-baseline relative animate-word-in",style:{fontFamily:p,fontSize:`${m}px`,fontWeight:500,letterSpacing:"0.01em"},children:[e.jsx("span",{className:"text-right",style:{color:r,minWidth:"42vw",paddingRight:"3px"},children:x}),e.jsxs("span",{className:"relative",style:{color:l,fontWeight:700},children:[y,e.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 rounded-full animate-breathe",style:{bottom:`-${m*.25}px`,width:`${Math.max(4,m*.12)}px`,height:`${Math.max(4,m*.12)}px`,backgroundColor:l,boxShadow:`0 0 8px ${l}60, 0 0 16px ${l}30`}})]}),e.jsx("span",{className:"text-left",style:{color:r,minWidth:"42vw",paddingLeft:"3px"},children:b})]},d.index)})})}),de=({book:d,onToggleChrome:i,isActive:a,showGhostWords:t=!0})=>{const n=E.getInstance(),r=q(),{settings:l,updateSettings:g}=V(),p=o.useRef(null),m=o.useRef(null),[u,v]=o.useState(!1),[x,y]=o.useState(0),[b,W]=o.useState(!1),[j,M]=o.useState(0),k=o.useRef(!1);o.useRef(0);const S=o.useRef(null),I=o.useRef(l.fontSize);o.useEffect(()=>{if(!d.chapters||d.chapters.length===0){v(!0);return}v(!1);const s=[...d.chapters].sort((w,f)=>w.sortOrder-f.sortOrder),h=[];for(const w of s)if(w.content){const f=w.content.replace(/<[^>]*>/g," ").replace(/&[a-z]+;/gi," ").replace(/\s+/g," ").trim();f&&h.push(f)}const c=h.join(`

`);n.load(c),M(n.total),d.lastTokenIndex!==void 0&&d.lastTokenIndex>0?n.position=d.lastTokenIndex:d.bookmarkProgress&&d.bookmarkProgress>0&&(n.progress=d.bookmarkProgress),n.wpm=l.wpm||300,y(n.position),v(!0),requestAnimationFrame(()=>{L(n.position,!1)})},[d.id]);const z=o.useRef();o.useEffect(()=>{const s=n.onPosition(c=>{y(c),n.isPlaying&&L(c,!0),d.lastTokenIndex=c,d.bookmarkProgress=n.progress,z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{B.getInstance().saveBook({...d,lastTokenIndex:c,bookmarkProgress:n.progress,lastOpened:new Date})},500)}),h=n.onPlayState(c=>{W(c),c||(setTimeout(()=>{L(n.position,!0)},100),B.getInstance().saveBook({...d,lastTokenIndex:n.position,bookmarkProgress:n.progress,lastOpened:new Date}))});return()=>{s(),h(),z.current&&clearTimeout(z.current)}},[d.id]);const L=o.useCallback((s,h)=>{if(!m.current||j===0)return;k.current=!0;const c=p.current;if(!c)return;const w=m.current.querySelector(`[data-start="${s}"]`);if(w){const f=w.offsetTop,P=w.offsetHeight,$=c.clientHeight,R=f-$/2+P/2;c.scrollTo({top:Math.max(0,R),behavior:h?"smooth":"instant"})}else{const P=s/j*(c.scrollHeight-c.clientHeight);c.scrollTo({top:P,behavior:h?"smooth":"instant"})}setTimeout(()=>{k.current=!1},h?500:50)},[j]);o.useEffect(()=>{const s=p.current;if(!s||!u)return;let h=!1;const c=()=>{k.current||h||(h=!0,requestAnimationFrame(()=>{if(!k.current&&s){const w=s.scrollTop/Math.max(1,s.scrollHeight-s.clientHeight),f=Math.floor(w*(j-1));Math.abs(f-x)>20&&(n.position=f)}h=!1}))};return s.addEventListener("scroll",c,{passive:!0}),()=>s.removeEventListener("scroll",c)},[u,j,x]),o.useEffect(()=>{const s=p.current;if(!s)return;const h=f=>{if(f.touches.length===2){const P=f.touches[0].clientX-f.touches[1].clientX,$=f.touches[0].clientY-f.touches[1].clientY;S.current=Math.sqrt(P*P+$*$),I.current=l.fontSize}},c=f=>{if(f.touches.length===2&&S.current!==null){f.preventDefault();const P=f.touches[0].clientX-f.touches[1].clientX,$=f.touches[0].clientY-f.touches[1].clientY,F=Math.sqrt(P*P+$*$)/S.current,G=Math.round(Math.max(12,Math.min(40,I.current*F)));G!==l.fontSize&&g({fontSize:G})}},w=()=>{S.current=null};return s.addEventListener("touchstart",h,{passive:!0}),s.addEventListener("touchmove",c,{passive:!1}),s.addEventListener("touchend",w,{passive:!0}),()=>{s.removeEventListener("touchstart",h),s.removeEventListener("touchmove",c),s.removeEventListener("touchend",w)}},[l.fontSize,g]);const N=o.useRef(null),T=o.useRef(null),_=o.useCallback(s=>{C.impactLight(),n.position=s,n.play()},[]),O=o.useCallback(()=>{C.impactMedium(),n.toggle()},[]),A=o.useCallback(s=>{const h="touches"in s?s.touches[0].clientX:s.clientX,c="touches"in s?s.touches[0].clientY:s.clientY;N.current={x:h,y:c,time:Date.now()},T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{C.impactLight()},500)},[]),H=o.useCallback(s=>{if(T.current&&(clearTimeout(T.current),T.current=null),!N.current)return;const h="changedTouches"in s?s.changedTouches[0].clientX:s.clientX,c="changedTouches"in s?s.changedTouches[0].clientY:s.clientY,w=Math.abs(h-N.current.x),f=Math.abs(c-N.current.y);if(Date.now()-N.current.time<400&&w<20&&f<20){let R=s.target,F;for(;R&&!F;)F=R.dataset?.idx,R=R.parentElement;F!==void 0?(s.preventDefault(),s.stopPropagation(),_(parseInt(F))):i()}N.current=null},[_,i]),Y=o.useCallback(()=>{T.current&&(clearTimeout(T.current),T.current=null),N.current=null},[]),D=o.useMemo(()=>j===0?[]:n.getParagraphs(0,1e4),[j,u]);return u?j===0?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{backgroundColor:r.background},children:e.jsxs("div",{className:"text-center px-8",children:[e.jsx("div",{className:"text-5xl mb-4 animate-bounce",children:"ðŸƒ"}),e.jsx("p",{className:"text-lg font-medium",style:{color:r.secondaryText},children:"nothing here yet~"}),e.jsx("p",{className:"text-sm mt-2 opacity-60",style:{color:r.secondaryText},children:"this book seems empty!"})]})}):e.jsxs("div",{ref:p,className:"absolute inset-0 overflow-y-auto overflow-x-hidden",style:{backgroundColor:r.background,WebkitOverflowScrolling:"touch",overscrollBehavior:"contain"},onTouchStart:A,onTouchEnd:H,onTouchCancel:Y,onMouseDown:A,onMouseUp:H,children:[b&&e.jsxs("div",{className:"fixed inset-0 z-50",style:{backgroundColor:r.background},onClick:O,children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-[0.03]",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E")`,backgroundRepeat:"repeat"}}),e.jsx(ce,{word:n.getCurrentWord(),nextWords:n.getRange(x+1,6),prevWords:n.getRange(Math.max(0,x-4),4),fontSize:l.fontSize,fontFamily:l.fontFamily,textColor:r.primaryText,accentColor:r.accent,showGhost:t}),e.jsx("div",{className:"absolute bottom-6 left-6 right-6 pointer-events-none",children:e.jsx("div",{className:"h-1 rounded-full overflow-hidden",style:{backgroundColor:`${r.primaryText}08`},children:e.jsx("div",{className:"h-full rounded-full",style:{backgroundColor:r.accent,opacity:.5,width:`${n.progress*100}%`,transition:"width 0.15s ease-out",boxShadow:`0 0 12px ${r.accent}40`}})})})]}),e.jsx("div",{ref:m,className:"w-full min-h-full",style:{maxWidth:"680px",margin:"0 auto",padding:"80px 24px 200px 24px"},children:D.map((s,h)=>{const c=Math.abs(s.startIndex-x)<500;return e.jsx(le,{words:s.words,startIndex:s.startIndex,activeIndex:x,isNearActive:c,fontSize:l.fontSize,lineHeight:l.lineHeight,paragraphSpacing:l.paragraphSpacing,fontFamily:l.fontFamily,textColor:r.primaryText,accentColor:r.accent,onWordTap:_},s.startIndex)})})]}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{backgroundColor:r.background},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 border-2 rounded-full animate-spin",style:{borderColor:r.accent,borderTopColor:"transparent"}}),e.jsx("span",{className:"text-sm lowercase tracking-wider",style:{color:r.secondaryText},children:"loading"})]})})},ge=({book:d,onClose:i})=>{const a=E.getInstance(),t=q(),{settings:n,updateSettings:r}=V(),[l,g]=o.useState(!0),[p,m]=o.useState(!1),[u,v]=o.useState(0),[x,y]=o.useState(n.rsvpSpeed||300),[b,W]=o.useState(n.showGhostPreview??!0),[j,M]=o.useState(!1),k=o.useRef(),S=o.useRef();o.useEffect(()=>{a.wpm=n.rsvpSpeed||300,y(a.wpm),W(n.showGhostPreview??!0);const s=a.onPosition(c=>{v(a.progress),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{const w={...d,lastTokenIndex:c,bookmarkProgress:a.progress,lastOpened:new Date};B.getInstance().saveBook(w)},500)}),h=a.onPlayState(c=>{m(c),c?k.current=setTimeout(()=>g(!1),3e3):g(!0)});return()=>{s(),h(),k.current&&clearTimeout(k.current),S.current&&clearTimeout(S.current)}},[d.id]),o.useEffect(()=>()=>a.stop(),[]);const I=o.useCallback(()=>{a.stop(),i(d.id,a.position,a.progress)},[d.id,i]),z=o.useCallback(()=>{C.impactMedium(),a.toggle()},[]),L=o.useCallback(()=>{C.impactLight(),a.skipBack(50)},[]),N=o.useCallback(s=>{C.impactLight();const h=Math.max(100,Math.min(800,x+s));a.wpm=h,y(h),r({rsvpSpeed:h,hasCustomSpeed:!0})},[x,r]),T=o.useCallback(()=>{C.impactLight();const s=!b;W(s),r({showGhostPreview:s})},[b,r]),_=o.useCallback(()=>{C.impactLight();const s=X.getInstance(),h=s.mode,c=h==="Night"?"Modern":h==="Modern"?"Sepia":"Night";s.setMode(c)},[]),O=o.useCallback(()=>{k.current&&clearTimeout(k.current),g(s=>!s),M(!1)},[]),A=o.useCallback(s=>{a.progress=parseFloat(s.target.value)},[]),H=o.useCallback(s=>{C.impactLight();const h=Math.max(14,Math.min(32,n.fontSize+s));r({fontSize:h})},[n.fontSize,r]);o.useEffect(()=>{const s=()=>{p?a.stop():I()};return window.addEventListener("popstate",s),()=>window.removeEventListener("popstate",s)},[p,I]);const Y=X.getInstance(),D=Y.mode==="Night"?J:Y.mode==="Sepia"?K:Q;return e.jsxs("div",{className:"fixed inset-0 z-50 w-full h-[100dvh] overflow-hidden",style:{backgroundColor:t.background},children:[e.jsx(de,{book:d,onToggleChrome:O,isActive:!0,showGhostWords:b}),e.jsx("div",{className:"fixed left-0 right-0 z-[60] flex justify-center pointer-events-none",style:{bottom:"max(20px, env(safe-area-inset-bottom))"},children:e.jsxs("div",{className:`pointer-events-auto shadow-xl backdrop-blur-2xl border flex flex-col rounded-2xl overflow-hidden transition-all duration-300 ease-out ${l?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{backgroundColor:t.surface+"f0",borderColor:t.borderColor,maxWidth:"420px",width:"calc(100% - 24px)"},children:[e.jsxs("div",{className:"px-4 pt-3 pb-1",children:[e.jsx("input",{type:"range",min:"0",max:"1",step:"0.0001",value:u,onChange:A,className:"w-full h-1.5 rounded-full appearance-none cursor-pointer touch-pan-x",style:{background:`linear-gradient(to right, ${t.accent} ${u*100}%, ${t.borderColor} ${u*100}%)`}}),e.jsxs("div",{className:"flex justify-between mt-1.5 px-0.5",children:[e.jsx("span",{className:"text-[10px] tabular-nums",style:{color:t.secondaryText,opacity:.6},children:u<.1?"ðŸŒ± just starting":u<.25?`${Math.round(u*100)}% ðŸŒ¿`:u<.5?`${Math.round(u*100)}% ðŸ“– nice pace`:u<.75?`${Math.round(u*100)}% âœ¨ halfway!`:u<.9?`${Math.round(u*100)}% ðŸ”¥ almost there`:`${Math.round(u*100)}% ðŸŽ¯ so close!`}),e.jsxs("span",{className:"text-[10px] tabular-nums",style:{color:t.secondaryText,opacity:.6},children:["~",Math.round((1-u)*a.total/Math.max(1,x)),"m left"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 px-1.5 pb-2",children:[e.jsx("button",{onClick:L,className:"w-9 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Rewind",children:e.jsx(Z,{size:18})}),e.jsx("div",{className:"w-px h-5",style:{backgroundColor:t.borderColor}}),e.jsx("button",{onClick:()=>N(-25),className:"w-8 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Slower",children:e.jsx(ee,{size:16})}),e.jsxs("div",{className:`h-9 px-2 rounded-xl flex items-center justify-center gap-1 min-w-[70px] transition-all duration-300 ${p?"animate-pulse-soft":""}`,style:{backgroundColor:p?`${t.accent}15`:`${t.primaryText}06`},children:[e.jsx("span",{className:"text-sm font-bold tabular-nums",style:{color:p?t.accent:t.primaryText},children:x}),e.jsx("span",{className:"text-[10px] lowercase opacity-50",style:{color:t.secondaryText},children:"wpm"})]}),e.jsx("button",{onClick:()=>N(25),className:"w-8 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Faster",children:e.jsx(te,{size:16})}),e.jsx("div",{className:"w-px h-5",style:{backgroundColor:t.borderColor}}),e.jsx("button",{onClick:z,className:`flex-1 flex items-center justify-center gap-1.5 h-9 rounded-xl font-semibold text-white shadow-md active:scale-[0.97] transition-all duration-150 text-sm hover:brightness-105 ${p?"":"animate-breathe"}`,style:{backgroundColor:t.accent,minWidth:"80px",boxShadow:p?`0 0 20px ${t.accent}40`:void 0},"aria-label":p?"Pause":"Play",children:p?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:16})," ",e.jsx("span",{className:"lowercase",children:"pause"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:16,className:"ml-0.5"})," ",e.jsx("span",{className:"lowercase",children:"flow~"})]})}),e.jsx("div",{className:"w-px h-5",style:{backgroundColor:t.borderColor}}),e.jsx("button",{onClick:T,className:`w-9 h-9 rounded-xl flex items-center justify-center transition-colors active:scale-90 ${b?"":"opacity-40"}`,style:{backgroundColor:b?`${t.accent}15`:"transparent",color:b?t.accent:t.secondaryText},"aria-label":"Toggle context",children:b?e.jsx(ie,{size:17}):e.jsx(ae,{size:17})}),e.jsx("button",{onClick:_,className:"w-9 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Toggle theme",children:e.jsx(D,{size:17})}),e.jsx("button",{onClick:()=>M(s=>!s),className:"w-9 h-9 rounded-xl flex items-center justify-center transition-colors active:scale-90",style:{backgroundColor:j?`${t.accent}15`:"transparent",color:j?t.accent:t.secondaryText},"aria-label":"Text size",children:e.jsx(oe,{size:17})})]}),j&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t",style:{borderColor:t.borderColor},children:[e.jsx("span",{className:"text-xs lowercase",style:{color:t.secondaryText},children:"text size"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>H(-2),className:"w-9 h-9 rounded-xl flex items-center justify-center active:scale-90 transition-transform",style:{backgroundColor:`${t.primaryText}06`,color:t.primaryText},children:e.jsx("span",{className:"text-sm",children:"A"})}),e.jsx("span",{className:"text-sm font-semibold w-8 text-center tabular-nums",style:{color:t.primaryText},children:n.fontSize}),e.jsx("button",{onClick:()=>H(2),className:"w-9 h-9 rounded-xl flex items-center justify-center active:scale-90 transition-transform",style:{backgroundColor:`${t.primaryText}06`,color:t.primaryText},children:e.jsx("span",{className:"text-lg",children:"A"})})]})]})]})}),e.jsx("div",{className:`fixed top-0 left-0 right-0 z-[60] transition-all duration-300 ease-out ${l?"translate-y-0 opacity-100":"-translate-y-full opacity-0 pointer-events-none"}`,children:e.jsx("div",{className:"backdrop-blur-2xl border-b",style:{backgroundColor:`${t.surface}e8`,borderColor:t.borderColor,paddingTop:"max(12px, env(safe-area-inset-top))"},children:e.jsxs("div",{className:"flex items-center px-4 pb-3",children:[e.jsx("button",{onClick:I,className:"w-10 h-10 rounded-full flex items-center justify-center transition-all active:scale-90",style:{backgroundColor:`${t.primaryText}08`,color:t.primaryText},"aria-label":"Back",children:e.jsx(re,{size:22})}),e.jsxs("div",{className:"flex-1 mx-3 text-center",children:[e.jsx("h1",{className:"text-sm font-semibold truncate",style:{color:t.primaryText},children:d.title}),e.jsx("p",{className:"text-[10px] opacity-50 truncate",style:{color:t.secondaryText},children:d.author})]}),e.jsx("div",{className:"w-10"})]})})}),e.jsx("style",{children:`
        input[type="range"] {
          -webkit-appearance: none;
          appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: ${t.accent};
          cursor: pointer;
          box-shadow: 0 1px 4px rgba(0,0,0,0.2);
        }
        input[type="range"]::-moz-range-thumb {
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: ${t.accent};
          cursor: pointer;
          box-shadow: 0 1px 4px rgba(0,0,0,0.2);
          border: none;
        }
      `})]})};export{ge as ReaderContainer};
