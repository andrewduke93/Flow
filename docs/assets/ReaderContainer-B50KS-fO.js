import{r,j as e,R as Y}from"./animations-D9Wo9mUM.js";import{u as D,T as O}from"./index-CaiCUtMC.js";import{u as G,R as $}from"./rsvp-ChCL7CNZ.js";import{T as z}from"./cloud-uA1tuQWL.js";import{M as V,l as q,m as X,n as U,o as K,P as J,p as Q,q as Z,E as ee,r as te,s as se,t as ne}from"./icons-DhCoUMbR.js";import"./vendor-react-uIRdnfX0.js";class F{constructor(){this.words=[],this.sourceText="",this.totalWords=0,this._position=0,this._isPlaying=!1,this._wpm=300,this.playbackTimer=null,this.positionListeners=new Set,this.playStateListeners=new Set}static getInstance(){return F.instance||(F.instance=new F),F.instance}load(n){if(this.stop(),this.sourceText=n,this.words=[],!n||n.length===0){this.totalWords=0;return}const a=Math.ceil(n.length/5);this.words=new Array(a);let t=0,s=-1,o=!0,d=!1;for(let x=0;x<=n.length;x++){const g=x<n.length?n[x]:" ",u=g===" "||g==="	"||g===`
`||g==="\r";if(g===`
`&&(d=!0),u&&!o&&s>=0){const w=n.slice(s,x);let v=0;const f=w[w.length-1];f==="."||f==="!"||f==="?"?v=2:(f===","||f===";"||f===":"||f==="â€”"||f==="â€“")&&(v=1),this.words[t]={text:w,start:s,end:x,index:t,trailingPause:v},t++,s=-1}else!u&&o&&(s=x,d&&t>0&&(this.words[t-1].trailingPause=3),d=!1);o=u}this.words.length=t,this.totalWords=t}get position(){return this._position}set position(n){const a=Math.max(0,Math.min(this.totalWords-1,n));a!==this._position&&(this._position=a,this.notifyPosition())}get progress(){return this.totalWords>0?this._position/this.totalWords:0}set progress(n){this.position=Math.floor(n*this.totalWords)}get total(){return this.totalWords}getWord(n){return this.words[n]||null}getCurrentWord(){return this.words[this._position]||null}getWindow(n,a){const t=Math.max(0,this._position-n),s=Math.min(this.totalWords,this._position+a);return this.words.slice(t,s)}getRange(n,a){const t=Math.max(0,n),s=Math.min(this.totalWords,t+a);return this.words.slice(t,s)}getParagraphs(n,a){const t=[];let s=[],o=n;for(let d=n;d<this.totalWords&&t.length<a;d++){const x=this.words[d];s.length===0&&(o=d),s.push(x),x.trailingPause===3&&(t.push({words:s,startIndex:o}),s=[])}return s.length>0&&t.length<a&&t.push({words:s,startIndex:o}),t}wordIndexFromProgress(n){return Math.floor(n*this.totalWords)}get isPlaying(){return this._isPlaying}get wpm(){return this._wpm}set wpm(n){this._wpm=Math.max(50,Math.min(1500,n)),this._isPlaying&&(this.stop(),this.play())}play(){this._isPlaying||this.totalWords===0||(this._isPlaying=!0,this.notifyPlayState(),this.scheduleNext())}stop(){this.playbackTimer!==null&&(clearTimeout(this.playbackTimer),this.playbackTimer=null),this._isPlaying&&(this._isPlaying=!1,this.notifyPlayState())}toggle(){this._isPlaying?this.stop():this.play()}scheduleNext(){if(!this._isPlaying)return;const n=this.getCurrentWord();if(!n){this.stop();return}let a=6e4/this._wpm;const t=n.trailingPause;t===1?a*=1.3:t===2?a*=1.8:t===3&&(a*=2.2);const s=n.text.length;s>10?a*=1.2:s>7?a*=1.1:s<=2&&(a*=.85),this.playbackTimer=window.setTimeout(()=>{this._position<this.totalWords-1?(this.position=this._position+1,this.scheduleNext()):this.stop()},a)}skipForward(n=10){this.position=this._position+n}skipBack(n=10){this.position=this._position-n}jumpToStart(){this.position=0}jumpToEnd(){this.position=this.totalWords-1}onPosition(n){return this.positionListeners.add(n),()=>this.positionListeners.delete(n)}onPlayState(n){return this.playStateListeners.add(n),()=>this.playStateListeners.delete(n)}notifyPosition(){const n=this._position;this.positionListeners.forEach(a=>a(n))}notifyPlayState(){const n=this._isPlaying;this.playStateListeners.forEach(a=>a(n))}getStats(){return{totalWords:this.totalWords,position:this._position,progress:this.progress,isPlaying:this._isPlaying,wpm:this._wpm}}cleanup(){this.stop(),this.words=[],this.sourceText="",this.totalWords=0,this._position=0}}const E={"New York":'"New York", "Iowan Old Style", Palatino, "Palatino Linotype", Georgia, serif',"SF Pro":'"SF Pro Text", "SF Pro", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',OpenDyslexic:'"OpenDyslexic", "Comic Sans MS", sans-serif',"Atkinson Hyperlegible":'"Atkinson Hyperlegible", "Trebuchet MS", Verdana, sans-serif'},ae="65ch",re=r.memo(({words:l,startIndex:n,activeIndex:a,isNearActive:t,isFirstParagraph:s,fontSize:o,lineHeight:d,paragraphSpacing:x,fontFamily:g,textColor:u,accentColor:h,onWordTap:w})=>{const v=E[g]||E["SF Pro"],f={fontSize:`${o}px`,lineHeight:d,fontFamily:v,color:u,textAlign:"justify",hyphens:"auto",WebkitHyphens:"auto",textRendering:"optimizeLegibility",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",fontKerning:"normal",fontFeatureSettings:'"kern" 1, "liga" 1, "calt" 1',orphans:2,widows:2,wordSpacing:"0.05em",letterSpacing:o>20?"-0.01em":"0",textIndent:s?"0":"1.5em",marginBottom:`${x}px`,marginTop:0,hangingPunctuation:"first last"};if(!t){const y=l.map(b=>b.text).join(" ");return e.jsx("p",{"data-start":n,style:f,children:y})}return e.jsx("p",{"data-start":n,style:f,children:l.map((y,b)=>{const k=y.index===a;return e.jsxs(Y.Fragment,{children:[e.jsx("span",{"data-idx":y.index,style:{backgroundColor:k?h:"transparent",color:k?"#FFFFFF":"inherit",padding:k?"2px 5px":"0",margin:k?"-2px -5px":"0",borderRadius:k?"4px":"0",transition:"background-color 0.1s ease-out, color 0.1s ease-out",boxShadow:k?`0 1px 4px ${h}30`:"none",whiteSpace:"nowrap"},children:y.text}),b<l.length-1?" ":""]},y.index)})})}),oe=r.memo(({word:l,nextWords:n,prevWords:a,fontSize:t,fontFamily:s,textColor:o,accentColor:d,showGhost:x})=>{if(!l)return null;const g=E[s]||E["SF Pro"],u=Math.min(t*2.2,56),h=l.text,w=h.length<=1?0:h.length<=5?1:h.length<=9?2:h.length<=13?3:4,v=h.slice(0,w),f=h[w]||"",y=h.slice(w+1);if(x){const b=u*.5,k=u*.9;return e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center select-none overflow-hidden",children:[a.length>0&&e.jsx("div",{className:"absolute text-right px-6",style:{bottom:`calc(50% + ${k}px)`,right:"50%",marginRight:`${u*.15}px`,fontFamily:g,fontSize:`${b}px`,color:o,opacity:.3,maxWidth:"45vw",lineHeight:1.5,textAlign:"justify"},children:a.map(P=>P.text).join(" ")}),e.jsx("div",{className:"relative flex items-center justify-center w-full",children:e.jsxs("div",{className:"flex items-baseline relative",style:{fontFamily:g,fontSize:`${u}px`,fontWeight:500,letterSpacing:"0.01em"},children:[e.jsx("span",{className:"text-right",style:{color:o,minWidth:"42vw",paddingRight:"3px"},children:v}),e.jsxs("span",{className:"relative",style:{color:d,fontWeight:700},children:[f,e.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 rounded-full",style:{bottom:`-${u*.25}px`,width:`${Math.max(4,u*.12)}px`,height:`${Math.max(4,u*.12)}px`,backgroundColor:d,boxShadow:`0 0 8px ${d}60, 0 0 16px ${d}30`}})]}),e.jsx("span",{className:"text-left",style:{color:o,minWidth:"42vw",paddingLeft:"3px"},children:y})]})}),n.length>0&&e.jsx("div",{className:"absolute text-left px-6",style:{top:`calc(50% + ${k}px)`,left:"50%",marginLeft:`${u*.15}px`,fontFamily:g,fontSize:`${b}px`,color:o,opacity:.25,maxWidth:"45vw",lineHeight:1.5,textAlign:"justify"},children:n.map(P=>P.text).join(" ")})]})}return e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center select-none overflow-hidden",children:e.jsx("div",{className:"relative flex items-center justify-center w-full",children:e.jsxs("div",{className:"flex items-baseline relative",style:{fontFamily:g,fontSize:`${u}px`,fontWeight:500,letterSpacing:"0.01em"},children:[e.jsx("span",{className:"text-right",style:{color:o,minWidth:"42vw",paddingRight:"3px"},children:v}),e.jsxs("span",{className:"relative",style:{color:d,fontWeight:700},children:[f,e.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 rounded-full",style:{bottom:`-${u*.25}px`,width:`${Math.max(4,u*.12)}px`,height:`${Math.max(4,u*.12)}px`,backgroundColor:d,boxShadow:`0 0 8px ${d}60, 0 0 16px ${d}30`}})]}),e.jsx("span",{className:"text-left",style:{color:o,minWidth:"42vw",paddingLeft:"3px"},children:y})]})})})}),ie=({book:l,onToggleChrome:n,isActive:a,showGhostWords:t=!0})=>{const s=F.getInstance(),o=D(),{settings:d}=G(),x=r.useRef(null),g=r.useRef(null),[u,h]=r.useState(!1),[w,v]=r.useState(0),[f,y]=r.useState(!1),[b,k]=r.useState(0),P=r.useRef(!1);r.useRef(0),r.useEffect(()=>{if(!l.chapters||l.chapters.length===0){h(!0);return}h(!1);const i=[...l.chapters].sort((T,c)=>T.sortOrder-c.sortOrder),m=[];for(const T of i)if(T.content){const c=T.content.replace(/<[^>]*>/g," ").replace(/&[a-z]+;/gi," ").replace(/\s+/g," ").trim();c&&m.push(c)}const p=m.join(`

`);s.load(p),k(s.total),l.lastTokenIndex!==void 0&&l.lastTokenIndex>0?s.position=l.lastTokenIndex:l.bookmarkProgress&&l.bookmarkProgress>0&&(s.progress=l.bookmarkProgress),s.wpm=d.wpm||300,v(s.position),h(!0),requestAnimationFrame(()=>{C(s.position,!1)})},[l.id]);const N=r.useRef();r.useEffect(()=>{const i=s.onPosition(p=>{v(p),s.isPlaying&&C(p,!0),l.lastTokenIndex=p,l.bookmarkProgress=s.progress,N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{z.getInstance().saveBook({...l,lastTokenIndex:p,bookmarkProgress:s.progress,lastOpened:new Date})},200)}),m=s.onPlayState(p=>{y(p),p||(setTimeout(()=>{C(s.position,!0)},100),z.getInstance().saveBook({...l,lastTokenIndex:s.position,bookmarkProgress:s.progress,lastOpened:new Date}))});return()=>{i(),m(),N.current&&(clearTimeout(N.current),z.getInstance().saveBook({...l,lastTokenIndex:s.position,bookmarkProgress:s.progress,lastOpened:new Date}))}},[l.id]);const C=r.useCallback((i,m)=>{if(!g.current||b===0)return;P.current=!0;const p=x.current;if(!p)return;const T=g.current.querySelector(`[data-start="${i}"]`);if(T){const c=T.offsetTop,S=T.offsetHeight,j=p.clientHeight,M=c-j/2+S/2;p.scrollTo({top:Math.max(0,M),behavior:m?"smooth":"instant"})}else{const S=i/b*(p.scrollHeight-p.clientHeight);p.scrollTo({top:S,behavior:m?"smooth":"instant"})}setTimeout(()=>{P.current=!1},m?500:50)},[b]);r.useEffect(()=>{const i=x.current;if(!i||!u)return;let m=!1;const p=()=>{P.current||m||(m=!0,requestAnimationFrame(()=>{if(!P.current&&i){const T=i.scrollTop/Math.max(1,i.scrollHeight-i.clientHeight),c=Math.floor(T*(b-1));Math.abs(c-w)>20&&(s.position=c)}m=!1}))};return i.addEventListener("scroll",p,{passive:!0}),()=>i.removeEventListener("scroll",p)},[u,b,w]);const W=r.useCallback(i=>{$.impactLight(),s.position=i,s.play()},[]),L=r.useCallback(()=>{$.impactMedium(),s.toggle()},[]),I=r.useRef(null),R=r.useCallback(i=>{i.pointerType==="touch"&&i.isPrimary===!1||(I.current={startX:i.clientX,startY:i.clientY,startTime:performance.now(),target:i.target})},[]),A=r.useCallback(i=>{const m=I.current;if(!m)return;I.current=null;const p=Math.abs(i.clientX-m.startX),T=Math.abs(i.clientY-m.startY);if(!(performance.now()-m.startTime<300&&p<15&&T<15))return;let j=i.target,M,_;for(;j&&j!==i.currentTarget&&(M||(M=j.dataset?.idx),_||(_=j.dataset?.start),!M);)j=j.parentElement;M!==void 0?(i.preventDefault(),W(parseInt(M))):_!==void 0?(i.preventDefault(),W(parseInt(_))):n()},[W,n]),B=r.useCallback(()=>{I.current=null},[]),H=r.useMemo(()=>b===0?[]:s.getParagraphs(0,1e4),[b,u]);return u?b===0?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{backgroundColor:o.background},children:e.jsxs("div",{className:"text-center px-8",children:[e.jsx("div",{className:"text-5xl mb-4 animate-bounce",children:"ðŸƒ"}),e.jsx("p",{className:"text-lg font-medium",style:{color:o.secondaryText},children:"nothing here yet~"}),e.jsx("p",{className:"text-sm mt-2 opacity-60",style:{color:o.secondaryText},children:"this book seems empty!"})]})}):e.jsxs("div",{ref:x,className:"absolute inset-0 overflow-y-auto overflow-x-hidden",style:{backgroundColor:o.background,WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",touchAction:"pan-y"},onPointerDown:R,onPointerUp:A,onPointerCancel:B,children:[f&&e.jsxs("div",{className:"fixed inset-0 z-50",style:{backgroundColor:o.background},onClick:L,children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-[0.03]",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E")`,backgroundRepeat:"repeat"}}),e.jsx(oe,{word:s.getCurrentWord(),nextWords:s.getRange(w+1,6),prevWords:s.getRange(Math.max(0,w-4),4),fontSize:d.fontSize,fontFamily:d.fontFamily,textColor:o.primaryText,accentColor:o.accent,showGhost:t}),e.jsx("div",{className:"absolute bottom-6 left-6 right-6 pointer-events-none",children:e.jsx("div",{className:"h-1 rounded-full overflow-hidden",style:{backgroundColor:`${o.primaryText}08`},children:e.jsx("div",{className:"h-full rounded-full",style:{backgroundColor:o.accent,opacity:.5,width:`${s.progress*100}%`,transition:"width 0.15s ease-out",boxShadow:`0 0 12px ${o.accent}40`}})})})]}),e.jsx("div",{ref:g,className:"w-full min-h-full",style:{maxWidth:ae,margin:"0 auto",padding:"clamp(60px, 12vh, 100px) clamp(16px, 5vw, 32px) 200px"},children:e.jsx("article",{className:"prose-flow",style:{},children:H.map((i,m)=>{const p=Math.abs(i.startIndex-w)<500,T=m===0;return e.jsx(re,{words:i.words,startIndex:i.startIndex,activeIndex:w,isNearActive:p,isFirstParagraph:T,fontSize:d.fontSize,lineHeight:d.lineHeight,paragraphSpacing:d.paragraphSpacing,fontFamily:d.fontFamily,textColor:o.primaryText,accentColor:o.accent,onWordTap:W},i.startIndex)})})})]}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{backgroundColor:o.background},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 border-2 rounded-full animate-spin",style:{borderColor:o.accent,borderTopColor:"transparent"}}),e.jsx("span",{className:"text-sm lowercase tracking-wider",style:{color:o.secondaryText},children:"loading"})]})})},xe=({book:l,onClose:n})=>{const a=F.getInstance(),t=D(),{settings:s,updateSettings:o}=G(),[d,x]=r.useState(!0),[g,u]=r.useState(!1),[h,w]=r.useState(0),[v,f]=r.useState(s.rsvpSpeed||300),[y,b]=r.useState(s.showGhostPreview??!0),[k,P]=r.useState(!1),N=r.useRef(),C=r.useRef();r.useEffect(()=>{a.wpm=s.rsvpSpeed||300,f(a.wpm),b(s.showGhostPreview??!0);const c=a.onPosition(j=>{w(a.progress),C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{const M={...l,lastTokenIndex:j,bookmarkProgress:a.progress,lastOpened:new Date};z.getInstance().saveBook(M)},200)}),S=a.onPlayState(j=>{if(u(j),j)N.current=setTimeout(()=>x(!1),3e3);else{x(!0),C.current&&clearTimeout(C.current);const M={...l,lastTokenIndex:a.position,bookmarkProgress:a.progress,lastOpened:new Date};z.getInstance().saveBook(M)}});return()=>{if(c(),S(),N.current&&clearTimeout(N.current),C.current){clearTimeout(C.current);const j={...l,lastTokenIndex:a.position,bookmarkProgress:a.progress,lastOpened:new Date};z.getInstance().saveBook(j)}}},[l.id]),r.useEffect(()=>()=>a.stop(),[]);const W=r.useCallback(()=>{a.stop(),n(l.id,a.position,a.progress)},[l.id,n]),L=r.useCallback(()=>{$.impactMedium(),a.toggle()},[]),I=r.useCallback(()=>{$.impactLight(),a.skipBack(50)},[]),R=r.useCallback(c=>{$.impactLight();const S=Math.max(100,Math.min(800,v+c));a.wpm=S,f(S),o({rsvpSpeed:S,hasCustomSpeed:!0})},[v,o]),A=r.useCallback(()=>{$.impactLight();const c=!y;b(c),o({showGhostPreview:c})},[y,o]),B=r.useCallback(()=>{$.impactLight();const c=O.getInstance(),S=c.mode,j=S==="Night"?"Modern":S==="Modern"?"Sepia":"Night";c.setMode(j)},[]),H=r.useCallback(()=>{N.current&&clearTimeout(N.current),x(c=>!c),P(!1)},[]),i=r.useCallback(c=>{a.progress=parseFloat(c.target.value)},[]),m=r.useCallback(c=>{$.impactLight();const S=Math.max(14,Math.min(32,s.fontSize+c));o({fontSize:S})},[s.fontSize,o]);r.useEffect(()=>{const c=()=>{g?a.stop():W()};return window.addEventListener("popstate",c),()=>window.removeEventListener("popstate",c)},[g,W]);const p=O.getInstance(),T=p.mode==="Night"?V:p.mode==="Sepia"?q:X;return e.jsxs("div",{className:"fixed inset-0 z-50 w-full h-[100dvh] overflow-hidden",style:{backgroundColor:t.background},children:[e.jsx(ie,{book:l,onToggleChrome:H,isActive:!0,showGhostWords:y}),e.jsx("div",{className:"fixed left-0 right-0 z-[60] flex justify-center pointer-events-none",style:{bottom:"max(20px, env(safe-area-inset-bottom))"},children:e.jsxs("div",{className:`pointer-events-auto shadow-xl backdrop-blur-2xl border flex flex-col rounded-2xl overflow-hidden transition-all duration-300 ease-out ${d?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{backgroundColor:t.surface+"f0",borderColor:t.borderColor,maxWidth:"420px",width:"calc(100% - 24px)"},children:[e.jsxs("div",{className:"px-4 pt-3 pb-1",children:[e.jsx("input",{type:"range",min:"0",max:"1",step:"0.0001",value:h,onChange:i,className:"w-full h-1.5 rounded-full appearance-none cursor-pointer touch-pan-x",style:{background:`linear-gradient(to right, ${t.accent} ${h*100}%, ${t.borderColor} ${h*100}%)`}}),e.jsxs("div",{className:"flex justify-between mt-1.5 px-0.5",children:[e.jsx("span",{className:"text-[10px] tabular-nums",style:{color:t.secondaryText,opacity:.6},children:h<.1?"ðŸŒ± just starting":h<.25?`${Math.round(h*100)}% ðŸŒ¿`:h<.5?`${Math.round(h*100)}% ðŸ“– nice pace`:h<.75?`${Math.round(h*100)}% âœ¨ halfway!`:h<.9?`${Math.round(h*100)}% ðŸ”¥ almost there`:`${Math.round(h*100)}% ðŸŽ¯ so close!`}),e.jsxs("span",{className:"text-[10px] tabular-nums",style:{color:t.secondaryText,opacity:.6},children:["~",Math.round((1-h)*a.total/Math.max(1,v)),"m left"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 px-1.5 pb-2",children:[e.jsx("button",{onClick:I,className:"w-9 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Rewind",children:e.jsx(U,{size:18})}),e.jsx("div",{className:"w-px h-5",style:{backgroundColor:t.borderColor}}),e.jsx("button",{onClick:()=>R(-25),className:"w-8 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Slower",children:e.jsx(K,{size:16})}),e.jsxs("div",{className:"h-9 px-2 rounded-xl flex items-center justify-center gap-1 min-w-[70px]",style:{backgroundColor:`${t.primaryText}06`},children:[e.jsx("span",{className:"text-sm font-bold tabular-nums",style:{color:t.primaryText},children:v}),e.jsx("span",{className:"text-[10px] lowercase opacity-50",style:{color:t.secondaryText},children:"wpm"})]}),e.jsx("button",{onClick:()=>R(25),className:"w-8 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Faster",children:e.jsx(J,{size:16})}),e.jsx("div",{className:"w-px h-5",style:{backgroundColor:t.borderColor}}),e.jsx("button",{onClick:L,className:"flex-1 flex items-center justify-center gap-1.5 h-9 rounded-xl font-semibold text-white shadow-md active:scale-[0.97] transition-all duration-150 text-sm hover:brightness-105",style:{backgroundColor:t.accent,minWidth:"80px"},"aria-label":g?"Pause":"Play",children:g?e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:16})," ",e.jsx("span",{className:"lowercase",children:"pause"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{size:16,className:"ml-0.5"})," ",e.jsx("span",{className:"lowercase",children:"flow~"})]})}),e.jsx("div",{className:"w-px h-5",style:{backgroundColor:t.borderColor}}),e.jsx("button",{onClick:A,className:`w-9 h-9 rounded-xl flex items-center justify-center transition-colors active:scale-90 ${y?"":"opacity-40"}`,style:{backgroundColor:y?`${t.accent}15`:"transparent",color:y?t.accent:t.secondaryText},"aria-label":"Toggle context",children:y?e.jsx(ee,{size:17}):e.jsx(te,{size:17})}),e.jsx("button",{onClick:B,className:"w-9 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Toggle theme",children:e.jsx(T,{size:17})}),e.jsx("button",{onClick:()=>P(c=>!c),className:"w-9 h-9 rounded-xl flex items-center justify-center transition-colors active:scale-90",style:{backgroundColor:k?`${t.accent}15`:"transparent",color:k?t.accent:t.secondaryText},"aria-label":"Text size",children:e.jsx(se,{size:17})})]}),k&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t",style:{borderColor:t.borderColor},children:[e.jsx("span",{className:"text-xs lowercase",style:{color:t.secondaryText},children:"text size"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>m(-2),className:"w-9 h-9 rounded-xl flex items-center justify-center active:scale-90 transition-transform",style:{backgroundColor:`${t.primaryText}06`,color:t.primaryText},children:e.jsx("span",{className:"text-sm",children:"A"})}),e.jsx("span",{className:"text-sm font-semibold w-8 text-center tabular-nums",style:{color:t.primaryText},children:s.fontSize}),e.jsx("button",{onClick:()=>m(2),className:"w-9 h-9 rounded-xl flex items-center justify-center active:scale-90 transition-transform",style:{backgroundColor:`${t.primaryText}06`,color:t.primaryText},children:e.jsx("span",{className:"text-lg",children:"A"})})]})]})]})}),e.jsx("div",{className:`fixed top-0 left-0 right-0 z-[60] transition-all duration-300 ease-out ${d?"translate-y-0 opacity-100":"-translate-y-full opacity-0 pointer-events-none"}`,children:e.jsx("div",{className:"backdrop-blur-2xl border-b",style:{backgroundColor:`${t.surface}e8`,borderColor:t.borderColor,paddingTop:"max(12px, env(safe-area-inset-top))"},children:e.jsxs("div",{className:"flex items-center px-4 pb-3",children:[e.jsx("button",{onClick:W,className:"w-10 h-10 rounded-full flex items-center justify-center transition-all active:scale-90",style:{backgroundColor:`${t.primaryText}08`,color:t.primaryText},"aria-label":"Back",children:e.jsx(ne,{size:22})}),e.jsxs("div",{className:"flex-1 mx-3 text-center",children:[e.jsx("h1",{className:"text-sm font-semibold truncate",style:{color:t.primaryText},children:l.title}),e.jsx("p",{className:"text-[10px] opacity-50 truncate",style:{color:t.secondaryText},children:l.author})]}),e.jsx("div",{className:"w-10"})]})})}),e.jsx("style",{children:`
        input[type="range"] {
          -webkit-appearance: none;
          appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: ${t.accent};
          cursor: pointer;
          box-shadow: 0 1px 4px rgba(0,0,0,0.2);
        }
        input[type="range"]::-moz-range-thumb {
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: ${t.accent};
          cursor: pointer;
          box-shadow: 0 1px 4px rgba(0,0,0,0.2);
          border: none;
        }
      `})]})};export{xe as ReaderContainer};
