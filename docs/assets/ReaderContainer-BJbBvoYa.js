import{r as i,j as e,R as G}from"./animations-D9Wo9mUM.js";import{u as O,T as B}from"./index-D6O_5dQL.js";import{u as D,R as M}from"./rsvp-ChCL7CNZ.js";import{T as R}from"./cloud-uA1tuQWL.js";import{M as Y,l as q,m as V,n as X,o as U,P as J,p as K,q as Q,E as Z,r as ee,s as te,t as se}from"./icons-DhCoUMbR.js";import"./vendor-react-uIRdnfX0.js";class I{constructor(){this.words=[],this.sourceText="",this.totalWords=0,this._position=0,this._isPlaying=!1,this._wpm=300,this.playbackTimer=null,this.positionListeners=new Set,this.playStateListeners=new Set}static getInstance(){return I.instance||(I.instance=new I),I.instance}load(n){if(this.stop(),this.sourceText=n,this.words=[],!n||n.length===0){this.totalWords=0;return}const a=Math.ceil(n.length/5);this.words=new Array(a);let t=0,s=-1,r=!0,d=!1;for(let x=0;x<=n.length;x++){const m=x<n.length?n[x]:" ",p=m===" "||m==="	"||m===`
`||m==="\r";if(m===`
`&&(d=!0),p&&!r&&s>=0){const b=n.slice(s,x);let f=0;const y=b[b.length-1];y==="."||y==="!"||y==="?"?f=2:(y===","||y===";"||y===":"||y==="â€”"||y==="â€“")&&(f=1),this.words[t]={text:b,start:s,end:x,index:t,trailingPause:f},t++,s=-1}else!p&&r&&(s=x,d&&t>0&&(this.words[t-1].trailingPause=3),d=!1);r=p}this.words.length=t,this.totalWords=t}get position(){return this._position}set position(n){const a=Math.max(0,Math.min(this.totalWords-1,n));a!==this._position&&(this._position=a,this.notifyPosition())}get progress(){return this.totalWords>0?this._position/this.totalWords:0}set progress(n){this.position=Math.floor(n*this.totalWords)}get total(){return this.totalWords}getWord(n){return this.words[n]||null}getCurrentWord(){return this.words[this._position]||null}getWindow(n,a){const t=Math.max(0,this._position-n),s=Math.min(this.totalWords,this._position+a);return this.words.slice(t,s)}getRange(n,a){const t=Math.max(0,n),s=Math.min(this.totalWords,t+a);return this.words.slice(t,s)}getParagraphs(n,a){const t=[];let s=[],r=n;for(let d=n;d<this.totalWords&&t.length<a;d++){const x=this.words[d];s.length===0&&(r=d),s.push(x),x.trailingPause===3&&(t.push({words:s,startIndex:r}),s=[])}return s.length>0&&t.length<a&&t.push({words:s,startIndex:r}),t}wordIndexFromProgress(n){return Math.floor(n*this.totalWords)}get isPlaying(){return this._isPlaying}get wpm(){return this._wpm}set wpm(n){this._wpm=Math.max(50,Math.min(1500,n)),this._isPlaying&&(this.stop(),this.play())}play(){this._isPlaying||this.totalWords===0||(this._isPlaying=!0,this.notifyPlayState(),this.scheduleNext())}stop(){this.playbackTimer!==null&&(clearTimeout(this.playbackTimer),this.playbackTimer=null),this._isPlaying&&(this._isPlaying=!1,this.notifyPlayState())}toggle(){this._isPlaying?this.stop():this.play()}scheduleNext(){if(!this._isPlaying)return;const n=this.getCurrentWord();if(!n){this.stop();return}let a=6e4/this._wpm;const t=n.trailingPause;t===1?a*=1.3:t===2?a*=1.8:t===3&&(a*=2.2);const s=n.text.length;s>10?a*=1.2:s>7?a*=1.1:s<=2&&(a*=.85),this.playbackTimer=window.setTimeout(()=>{this._position<this.totalWords-1?(this.position=this._position+1,this.scheduleNext()):this.stop()},a)}skipForward(n=10){this.position=this._position+n}skipBack(n=10){this.position=this._position-n}jumpToStart(){this.position=0}jumpToEnd(){this.position=this.totalWords-1}onPosition(n){return this.positionListeners.add(n),()=>this.positionListeners.delete(n)}onPlayState(n){return this.playStateListeners.add(n),()=>this.playStateListeners.delete(n)}notifyPosition(){const n=this._position;this.positionListeners.forEach(a=>a(n))}notifyPlayState(){const n=this._isPlaying;this.playStateListeners.forEach(a=>a(n))}getStats(){return{totalWords:this.totalWords,position:this._position,progress:this.progress,isPlaying:this._isPlaying,wpm:this._wpm}}cleanup(){this.stop(),this.words=[],this.sourceText="",this.totalWords=0,this._position=0}}const ne=i.memo(({words:l,startIndex:n,activeIndex:a,isNearActive:t,fontSize:s,lineHeight:r,paragraphSpacing:d,fontFamily:x,textColor:m,accentColor:p,onWordTap:h})=>{const b=x==="New York"?'"New York", "Iowan Old Style", Georgia, serif':x==="OpenDyslexic"?'"OpenDyslexic", sans-serif':x==="Atkinson Hyperlegible"?'"Atkinson Hyperlegible", sans-serif':"system-ui, -apple-system, sans-serif";if(!t){const f=l.map(y=>y.text).join(" ");return e.jsx("p",{"data-start":n,style:{fontSize:`${s}px`,lineHeight:r,marginBottom:`${d}px`,fontFamily:b,color:m,textAlign:"justify",hyphens:"auto",WebkitHyphens:"auto",textRendering:"optimizeLegibility",WebkitFontSmoothing:"antialiased"},children:f})}return e.jsx("p",{"data-start":n,style:{fontSize:`${s}px`,lineHeight:r,marginBottom:`${d}px`,fontFamily:b,color:m,textAlign:"justify",hyphens:"auto",WebkitHyphens:"auto",textRendering:"optimizeLegibility",WebkitFontSmoothing:"antialiased"},children:l.map((f,y)=>{const w=f.index===a;return e.jsxs(G.Fragment,{children:[e.jsx("span",{"data-idx":f.index,style:{backgroundColor:w?p:"transparent",color:w?"#FFFFFF":"inherit",padding:w?"3px 6px":"0",margin:w?"-3px -6px":"0",borderRadius:w?"6px":"0",transition:"all 0.15s ease-out",boxShadow:w?`0 2px 8px ${p}40`:"none"},children:f.text}),y<l.length-1?" ":""]},f.index)})})}),ae=i.memo(({word:l,nextWords:n,prevWords:a,fontSize:t,fontFamily:s,textColor:r,accentColor:d,showGhost:x})=>{if(!l)return null;const m=s==="New York"?'"New York", "Iowan Old Style", Georgia, serif':s==="OpenDyslexic"?'"OpenDyslexic", sans-serif':s==="Atkinson Hyperlegible"?'"Atkinson Hyperlegible", sans-serif':"system-ui, -apple-system, sans-serif",p=Math.min(t*2.2,56),h=l.text,b=h.length<=1?0:h.length<=5?1:h.length<=9?2:h.length<=13?3:4,f=h.slice(0,b),y=h[b]||"",w=h.slice(b+1);if(x){const k=p*.5,W=p*.9;return e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center select-none overflow-hidden",children:[a.length>0&&e.jsx("div",{className:"absolute text-right px-6",style:{bottom:`calc(50% + ${W}px)`,right:"50%",marginRight:`${p*.15}px`,fontFamily:m,fontSize:`${k}px`,color:r,opacity:.3,maxWidth:"45vw",lineHeight:1.5,textAlign:"justify"},children:a.map(N=>N.text).join(" ")}),e.jsx("div",{className:"relative flex items-center justify-center w-full",children:e.jsxs("div",{className:"flex items-baseline relative",style:{fontFamily:m,fontSize:`${p}px`,fontWeight:500,letterSpacing:"0.01em"},children:[e.jsx("span",{className:"text-right",style:{color:r,minWidth:"42vw",paddingRight:"3px"},children:f}),e.jsxs("span",{className:"relative",style:{color:d,fontWeight:700},children:[y,e.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 rounded-full",style:{bottom:`-${p*.25}px`,width:`${Math.max(4,p*.12)}px`,height:`${Math.max(4,p*.12)}px`,backgroundColor:d,boxShadow:`0 0 8px ${d}60, 0 0 16px ${d}30`}})]}),e.jsx("span",{className:"text-left",style:{color:r,minWidth:"42vw",paddingLeft:"3px"},children:w})]})}),n.length>0&&e.jsx("div",{className:"absolute text-left px-6",style:{top:`calc(50% + ${W}px)`,left:"50%",marginLeft:`${p*.15}px`,fontFamily:m,fontSize:`${k}px`,color:r,opacity:.25,maxWidth:"45vw",lineHeight:1.5,textAlign:"justify"},children:n.map(N=>N.text).join(" ")})]})}return e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center select-none overflow-hidden",children:e.jsx("div",{className:"relative flex items-center justify-center w-full",children:e.jsxs("div",{className:"flex items-baseline relative",style:{fontFamily:m,fontSize:`${p}px`,fontWeight:500,letterSpacing:"0.01em"},children:[e.jsx("span",{className:"text-right",style:{color:r,minWidth:"42vw",paddingRight:"3px"},children:f}),e.jsxs("span",{className:"relative",style:{color:d,fontWeight:700},children:[y,e.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 rounded-full",style:{bottom:`-${p*.25}px`,width:`${Math.max(4,p*.12)}px`,height:`${Math.max(4,p*.12)}px`,backgroundColor:d,boxShadow:`0 0 8px ${d}60, 0 0 16px ${d}30`}})]}),e.jsx("span",{className:"text-left",style:{color:r,minWidth:"42vw",paddingLeft:"3px"},children:w})]})})})}),ie=({book:l,onToggleChrome:n,isActive:a,showGhostWords:t=!0})=>{const s=I.getInstance(),r=O(),{settings:d}=D(),x=i.useRef(null),m=i.useRef(null),[p,h]=i.useState(!1),[b,f]=i.useState(0),[y,w]=i.useState(!1),[k,W]=i.useState(0),N=i.useRef(!1);i.useRef(0),i.useEffect(()=>{if(!l.chapters||l.chapters.length===0){h(!0);return}h(!1);const o=[...l.chapters].sort((T,c)=>T.sortOrder-c.sortOrder),g=[];for(const T of o)if(T.content){const c=T.content.replace(/<[^>]*>/g," ").replace(/&[a-z]+;/gi," ").replace(/\s+/g," ").trim();c&&g.push(c)}const u=g.join(`

`);s.load(u),W(s.total),l.lastTokenIndex!==void 0&&l.lastTokenIndex>0?s.position=l.lastTokenIndex:l.bookmarkProgress&&l.bookmarkProgress>0&&(s.progress=l.bookmarkProgress),s.wpm=d.wpm||300,f(s.position),h(!0),requestAnimationFrame(()=>{P(s.position,!1)})},[l.id]);const S=i.useRef();i.useEffect(()=>{const o=s.onPosition(u=>{f(u),s.isPlaying&&P(u,!0),l.lastTokenIndex=u,l.bookmarkProgress=s.progress,S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{R.getInstance().saveBook({...l,lastTokenIndex:u,bookmarkProgress:s.progress,lastOpened:new Date})},200)}),g=s.onPlayState(u=>{w(u),u||(setTimeout(()=>{P(s.position,!0)},100),R.getInstance().saveBook({...l,lastTokenIndex:s.position,bookmarkProgress:s.progress,lastOpened:new Date}))});return()=>{o(),g(),S.current&&(clearTimeout(S.current),R.getInstance().saveBook({...l,lastTokenIndex:s.position,bookmarkProgress:s.progress,lastOpened:new Date}))}},[l.id]);const P=i.useCallback((o,g)=>{if(!m.current||k===0)return;N.current=!0;const u=x.current;if(!u)return;const T=m.current.querySelector(`[data-start="${o}"]`);if(T){const c=T.offsetTop,j=T.offsetHeight,v=u.clientHeight,C=c-v/2+j/2;u.scrollTo({top:Math.max(0,C),behavior:g?"smooth":"instant"})}else{const j=o/k*(u.scrollHeight-u.clientHeight);u.scrollTo({top:j,behavior:g?"smooth":"instant"})}setTimeout(()=>{N.current=!1},g?500:50)},[k]);i.useEffect(()=>{const o=x.current;if(!o||!p)return;let g=!1;const u=()=>{N.current||g||(g=!0,requestAnimationFrame(()=>{if(!N.current&&o){const T=o.scrollTop/Math.max(1,o.scrollHeight-o.clientHeight),c=Math.floor(T*(k-1));Math.abs(c-b)>20&&(s.position=c)}g=!1}))};return o.addEventListener("scroll",u,{passive:!0}),()=>o.removeEventListener("scroll",u)},[p,k,b]);const $=i.useCallback(o=>{M.impactLight(),s.position=o,s.play()},[]),E=i.useCallback(()=>{M.impactMedium(),s.toggle()},[]),z=i.useRef(null),F=i.useCallback(o=>{o.pointerType==="touch"&&o.isPrimary===!1||(z.current={startX:o.clientX,startY:o.clientY,startTime:performance.now(),target:o.target})},[]),L=i.useCallback(o=>{const g=z.current;if(!g)return;z.current=null;const u=Math.abs(o.clientX-g.startX),T=Math.abs(o.clientY-g.startY);if(!(performance.now()-g.startTime<300&&u<15&&T<15))return;let v=o.target,C,_;for(;v&&v!==o.currentTarget&&(C||(C=v.dataset?.idx),_||(_=v.dataset?.start),!C);)v=v.parentElement;C!==void 0?(o.preventDefault(),$(parseInt(C))):_!==void 0?(o.preventDefault(),$(parseInt(_))):n()},[$,n]),A=i.useCallback(()=>{z.current=null},[]),H=i.useMemo(()=>k===0?[]:s.getParagraphs(0,1e4),[k,p]);return p?k===0?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{backgroundColor:r.background},children:e.jsxs("div",{className:"text-center px-8",children:[e.jsx("div",{className:"text-5xl mb-4 animate-bounce",children:"ðŸƒ"}),e.jsx("p",{className:"text-lg font-medium",style:{color:r.secondaryText},children:"nothing here yet~"}),e.jsx("p",{className:"text-sm mt-2 opacity-60",style:{color:r.secondaryText},children:"this book seems empty!"})]})}):e.jsxs("div",{ref:x,className:"absolute inset-0 overflow-y-auto overflow-x-hidden",style:{backgroundColor:r.background,WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",touchAction:"pan-y"},onPointerDown:F,onPointerUp:L,onPointerCancel:A,children:[y&&e.jsxs("div",{className:"fixed inset-0 z-50",style:{backgroundColor:r.background},onClick:E,children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-[0.03]",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E")`,backgroundRepeat:"repeat"}}),e.jsx(ae,{word:s.getCurrentWord(),nextWords:s.getRange(b+1,6),prevWords:s.getRange(Math.max(0,b-4),4),fontSize:d.fontSize,fontFamily:d.fontFamily,textColor:r.primaryText,accentColor:r.accent,showGhost:t}),e.jsx("div",{className:"absolute bottom-6 left-6 right-6 pointer-events-none",children:e.jsx("div",{className:"h-1 rounded-full overflow-hidden",style:{backgroundColor:`${r.primaryText}08`},children:e.jsx("div",{className:"h-full rounded-full",style:{backgroundColor:r.accent,opacity:.5,width:`${s.progress*100}%`,transition:"width 0.15s ease-out",boxShadow:`0 0 12px ${r.accent}40`}})})})]}),e.jsx("div",{ref:m,className:"w-full min-h-full",style:{maxWidth:"680px",margin:"0 auto",padding:"80px 24px 200px 24px"},children:H.map((o,g)=>{const u=Math.abs(o.startIndex-b)<500;return e.jsx(ne,{words:o.words,startIndex:o.startIndex,activeIndex:b,isNearActive:u,fontSize:d.fontSize,lineHeight:d.lineHeight,paragraphSpacing:d.paragraphSpacing,fontFamily:d.fontFamily,textColor:r.primaryText,accentColor:r.accent,onWordTap:$},o.startIndex)})})]}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{backgroundColor:r.background},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 border-2 rounded-full animate-spin",style:{borderColor:r.accent,borderTopColor:"transparent"}}),e.jsx("span",{className:"text-sm lowercase tracking-wider",style:{color:r.secondaryText},children:"loading"})]})})},pe=({book:l,onClose:n})=>{const a=I.getInstance(),t=O(),{settings:s,updateSettings:r}=D(),[d,x]=i.useState(!0),[m,p]=i.useState(!1),[h,b]=i.useState(0),[f,y]=i.useState(s.rsvpSpeed||300),[w,k]=i.useState(s.showGhostPreview??!0),[W,N]=i.useState(!1),S=i.useRef(),P=i.useRef();i.useEffect(()=>{a.wpm=s.rsvpSpeed||300,y(a.wpm),k(s.showGhostPreview??!0);const c=a.onPosition(v=>{b(a.progress),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{const C={...l,lastTokenIndex:v,bookmarkProgress:a.progress,lastOpened:new Date};R.getInstance().saveBook(C)},200)}),j=a.onPlayState(v=>{if(p(v),v)S.current=setTimeout(()=>x(!1),3e3);else{x(!0),P.current&&clearTimeout(P.current);const C={...l,lastTokenIndex:a.position,bookmarkProgress:a.progress,lastOpened:new Date};R.getInstance().saveBook(C)}});return()=>{if(c(),j(),S.current&&clearTimeout(S.current),P.current){clearTimeout(P.current);const v={...l,lastTokenIndex:a.position,bookmarkProgress:a.progress,lastOpened:new Date};R.getInstance().saveBook(v)}}},[l.id]),i.useEffect(()=>()=>a.stop(),[]);const $=i.useCallback(()=>{a.stop(),n(l.id,a.position,a.progress)},[l.id,n]),E=i.useCallback(()=>{M.impactMedium(),a.toggle()},[]),z=i.useCallback(()=>{M.impactLight(),a.skipBack(50)},[]),F=i.useCallback(c=>{M.impactLight();const j=Math.max(100,Math.min(800,f+c));a.wpm=j,y(j),r({rsvpSpeed:j,hasCustomSpeed:!0})},[f,r]),L=i.useCallback(()=>{M.impactLight();const c=!w;k(c),r({showGhostPreview:c})},[w,r]),A=i.useCallback(()=>{M.impactLight();const c=B.getInstance(),j=c.mode,v=j==="Night"?"Modern":j==="Modern"?"Sepia":"Night";c.setMode(v)},[]),H=i.useCallback(()=>{S.current&&clearTimeout(S.current),x(c=>!c),N(!1)},[]),o=i.useCallback(c=>{a.progress=parseFloat(c.target.value)},[]),g=i.useCallback(c=>{M.impactLight();const j=Math.max(14,Math.min(32,s.fontSize+c));r({fontSize:j})},[s.fontSize,r]);i.useEffect(()=>{const c=()=>{m?a.stop():$()};return window.addEventListener("popstate",c),()=>window.removeEventListener("popstate",c)},[m,$]);const u=B.getInstance(),T=u.mode==="Night"?Y:u.mode==="Sepia"?q:V;return e.jsxs("div",{className:"fixed inset-0 z-50 w-full h-[100dvh] overflow-hidden",style:{backgroundColor:t.background},children:[e.jsx(ie,{book:l,onToggleChrome:H,isActive:!0,showGhostWords:w}),e.jsx("div",{className:"fixed left-0 right-0 z-[60] flex justify-center pointer-events-none",style:{bottom:"max(20px, env(safe-area-inset-bottom))"},children:e.jsxs("div",{className:`pointer-events-auto shadow-xl backdrop-blur-2xl border flex flex-col rounded-2xl overflow-hidden transition-all duration-300 ease-out ${d?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{backgroundColor:t.surface+"f0",borderColor:t.borderColor,maxWidth:"420px",width:"calc(100% - 24px)"},children:[e.jsxs("div",{className:"px-4 pt-3 pb-1",children:[e.jsx("input",{type:"range",min:"0",max:"1",step:"0.0001",value:h,onChange:o,className:"w-full h-1.5 rounded-full appearance-none cursor-pointer touch-pan-x",style:{background:`linear-gradient(to right, ${t.accent} ${h*100}%, ${t.borderColor} ${h*100}%)`}}),e.jsxs("div",{className:"flex justify-between mt-1.5 px-0.5",children:[e.jsx("span",{className:"text-[10px] tabular-nums",style:{color:t.secondaryText,opacity:.6},children:h<.1?"ðŸŒ± just starting":h<.25?`${Math.round(h*100)}% ðŸŒ¿`:h<.5?`${Math.round(h*100)}% ðŸ“– nice pace`:h<.75?`${Math.round(h*100)}% âœ¨ halfway!`:h<.9?`${Math.round(h*100)}% ðŸ”¥ almost there`:`${Math.round(h*100)}% ðŸŽ¯ so close!`}),e.jsxs("span",{className:"text-[10px] tabular-nums",style:{color:t.secondaryText,opacity:.6},children:["~",Math.round((1-h)*a.total/Math.max(1,f)),"m left"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 px-1.5 pb-2",children:[e.jsx("button",{onClick:z,className:"w-9 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Rewind",children:e.jsx(X,{size:18})}),e.jsx("div",{className:"w-px h-5",style:{backgroundColor:t.borderColor}}),e.jsx("button",{onClick:()=>F(-25),className:"w-8 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Slower",children:e.jsx(U,{size:16})}),e.jsxs("div",{className:"h-9 px-2 rounded-xl flex items-center justify-center gap-1 min-w-[70px]",style:{backgroundColor:`${t.primaryText}06`},children:[e.jsx("span",{className:"text-sm font-bold tabular-nums",style:{color:t.primaryText},children:f}),e.jsx("span",{className:"text-[10px] lowercase opacity-50",style:{color:t.secondaryText},children:"wpm"})]}),e.jsx("button",{onClick:()=>F(25),className:"w-8 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Faster",children:e.jsx(J,{size:16})}),e.jsx("div",{className:"w-px h-5",style:{backgroundColor:t.borderColor}}),e.jsx("button",{onClick:E,className:"flex-1 flex items-center justify-center gap-1.5 h-9 rounded-xl font-semibold text-white shadow-md active:scale-[0.97] transition-all duration-150 text-sm hover:brightness-105",style:{backgroundColor:t.accent,minWidth:"80px"},"aria-label":m?"Pause":"Play",children:m?e.jsxs(e.Fragment,{children:[e.jsx(K,{size:16})," ",e.jsx("span",{className:"lowercase",children:"pause"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:16,className:"ml-0.5"})," ",e.jsx("span",{className:"lowercase",children:"flow~"})]})}),e.jsx("div",{className:"w-px h-5",style:{backgroundColor:t.borderColor}}),e.jsx("button",{onClick:L,className:`w-9 h-9 rounded-xl flex items-center justify-center transition-colors active:scale-90 ${w?"":"opacity-40"}`,style:{backgroundColor:w?`${t.accent}15`:"transparent",color:w?t.accent:t.secondaryText},"aria-label":"Toggle context",children:w?e.jsx(Z,{size:17}):e.jsx(ee,{size:17})}),e.jsx("button",{onClick:A,className:"w-9 h-9 rounded-xl flex items-center justify-center hover:bg-black/5 transition-colors active:scale-90",style:{color:t.secondaryText},"aria-label":"Toggle theme",children:e.jsx(T,{size:17})}),e.jsx("button",{onClick:()=>N(c=>!c),className:"w-9 h-9 rounded-xl flex items-center justify-center transition-colors active:scale-90",style:{backgroundColor:W?`${t.accent}15`:"transparent",color:W?t.accent:t.secondaryText},"aria-label":"Text size",children:e.jsx(te,{size:17})})]}),W&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t",style:{borderColor:t.borderColor},children:[e.jsx("span",{className:"text-xs lowercase",style:{color:t.secondaryText},children:"text size"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>g(-2),className:"w-9 h-9 rounded-xl flex items-center justify-center active:scale-90 transition-transform",style:{backgroundColor:`${t.primaryText}06`,color:t.primaryText},children:e.jsx("span",{className:"text-sm",children:"A"})}),e.jsx("span",{className:"text-sm font-semibold w-8 text-center tabular-nums",style:{color:t.primaryText},children:s.fontSize}),e.jsx("button",{onClick:()=>g(2),className:"w-9 h-9 rounded-xl flex items-center justify-center active:scale-90 transition-transform",style:{backgroundColor:`${t.primaryText}06`,color:t.primaryText},children:e.jsx("span",{className:"text-lg",children:"A"})})]})]})]})}),e.jsx("div",{className:`fixed top-0 left-0 right-0 z-[60] transition-all duration-300 ease-out ${d?"translate-y-0 opacity-100":"-translate-y-full opacity-0 pointer-events-none"}`,children:e.jsx("div",{className:"backdrop-blur-2xl border-b",style:{backgroundColor:`${t.surface}e8`,borderColor:t.borderColor,paddingTop:"max(12px, env(safe-area-inset-top))"},children:e.jsxs("div",{className:"flex items-center px-4 pb-3",children:[e.jsx("button",{onClick:$,className:"w-10 h-10 rounded-full flex items-center justify-center transition-all active:scale-90",style:{backgroundColor:`${t.primaryText}08`,color:t.primaryText},"aria-label":"Back",children:e.jsx(se,{size:22})}),e.jsxs("div",{className:"flex-1 mx-3 text-center",children:[e.jsx("h1",{className:"text-sm font-semibold truncate",style:{color:t.primaryText},children:l.title}),e.jsx("p",{className:"text-[10px] opacity-50 truncate",style:{color:t.secondaryText},children:l.author})]}),e.jsx("div",{className:"w-10"})]})})}),e.jsx("style",{children:`
        input[type="range"] {
          -webkit-appearance: none;
          appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: ${t.accent};
          cursor: pointer;
          box-shadow: 0 1px 4px rgba(0,0,0,0.2);
        }
        input[type="range"]::-moz-range-thumb {
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: ${t.accent};
          cursor: pointer;
          box-shadow: 0 1px 4px rgba(0,0,0,0.2);
          border: none;
        }
      `})]})};export{pe as ReaderContainer};
